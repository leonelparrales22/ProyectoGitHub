------- vista materialziada grupo 2
CREATE MATERIALIZED VIEW TH2_VISTA_GENERAL AS
(
SELECT ANIO "AÑO",NOMBRE_REGION REGION ,NOMBRE_PROVINCIA PROVINCIA,NOMBRE_SERVICIO SERVICIO , SUM(TOTAL_GASTOS) GASTOS,SUM(TOTAL_INGRESOS) INGRESOS,SUM(TOTAL_EMPRESAS) EMPRESAS 
FROM th_hrs_2 TH,D_TIPO_SERVICIO S,D_UBICACION U,D_TIEMPO T
WHERE TH.ID_TIEMPO=T.ID_TIEMPO
AND TH.id_ubicacion=U.id_ubicacion
AND TH.id_TIPO_SERVICIO=S.id_TIPO_SERVICIO
GROUP BY ANIO,NOMBRE_REGION ,NOMBRE_PROVINCIA ,NOMBRE_SERVICIO 
);



CREATE MATERIALIZED VIEW TH2_VISTA_TOP10_GASTOS AS
(
SELECT PROVINCIA,SERVICIO,SUM(GASTOS) GASTOS,SUM(INGRESOS) INGRESOS  FROM TH2_VISTA_GENERAL
WHERE ROWNUM <= 10
GROUP BY PROVINCIA,SERVICIO
ORDER BY 3 DESC
);

CREATE MATERIALIZED VIEW TH2_VISTA_TOP10_INGRESOS AS
(
SELECT PROVINCIA,SERVICIO,SUM(GASTOS) GASTOS,SUM(INGRESOS) INGRESOS  FROM TH2_VISTA_GENERAL
WHERE ROWNUM <= 10
GROUP BY PROVINCIA,SERVICIO
ORDER BY 4 DESC
);

------------ vista materializada grupo 1

CREATE MATERIALIZED VIEW TH1_VISTA_GENERAL AS
(
SELECT ANIO "AÑO",NOMBRE_REGION REGION ,NOMBRE_PROVINCIA PROVINCIA,NOMBRE_SERVICIO SERVICIO , SUM(NUM_TRAB_H) HOMBRES,SUM(NUM_TRAB_M) MUJERES,SUM(TOTAL_GASTOS_SB) GASTOS_SERVICIOS_BASICOS,SUM(TOTAL_SUELDOS_H) SUELDOS_HOMBRES,SUM(TOTAL_SUELDOS_M) SUELDOS_MUJERES, SUM(TOTAL_EO_H) EMPLEADOS_OBREROS_HOMBRES,SUM(TOTAL_EO_H) EMPLEADOS_OBREROS_MUJERES, SUM(TOTAL_EMPRESAS) EMPRESAS  
FROM th_hrs_1 TH,D_TIPO_SERVICIO S,D_UBICACION U,D_TIEMPO T
WHERE TH.ID_TIEMPO=T.ID_TIEMPO
AND TH.id_ubicacion=U.id_ubicacion
AND TH.id_TIPO_SERVICIO=S.id_TIPO_SERVICIO
GROUP BY ANIO,NOMBRE_REGION ,NOMBRE_PROVINCIA ,NOMBRE_SERVICIO 
);